<html>
  <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="info-bubble.min.js"></script>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Info windows</title>
    <style>
      #map {
        height: 100%;
      } 
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #infobubble-container {
        visibility: hidden;
      }
      #slider-container {
        position: relative;
        overflow: hidden;
        margin: 0 auto;
      }
      #ul-slider{
        margin:0; 
        padding:0;
        position: relative;
        list-style:none;
      }
      .li-slider{
        position: relative;
        display: inline-block;
        float: left;
        width:230px;
        height:445px;
      }
      #navlist li{
        display: inline;
        list-style-type: none;
        margin:0px 1px;
      }
      .js-info-bubble-close{
        display: none;
      }
      </style>
<script>
function sliderLoad(){
  
  var slide = $('.li-slider').length;
  var slideWidth = $('.li-slider').width();
  var slideHeight = $('.li-slider').height();
  var sliderUlWidth = slide * slideWidth;

  $('#slider-container').css({ width: slideWidth, height: slideHeight });

  $('#ul-slider').css({ width: sliderUlWidth, marginLeft: - slideWidth });

  $('#ul-slider li:last-child').prependTo('#ul-slider');

  $('#infobubble-container').css({ visibility: 'visible' });

  function moveLeft() {
    $('#ul-slider').animate({
        left: + slideWidth
    }, 200, function () {
        $('#ul-slider li:last-child').prependTo('#ul-slider');
        $('#ul-slider').css('left', '');
        $("#navlist li:last").detach().insertBefore("#navlist li:first");
    });
  };

  window.moveLeft = moveLeft;

  function moveRight() {
    $('#ul-slider').animate({
        left: - slideWidth
    }, 200, function () {
        $('#ul-slider li:first-child').appendTo('#ul-slider');
        $('#ul-slider').css('left', '');
        $("#navlist li:first").detach().insertAfter("#navlist li:last");
    });
  };

  window.moveRight = moveRight
  // });   
}
</script>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var mapLocations = [
        {
          name: "LA",
          lat:34.019657,
          lng:-118.280869,
          content: 
          '<div id="infobubble-container">'+
          '<div id="slider-container">'+
            '<ul id="ul-slider">'+
                '<li class="li-slider first">'+
                '<video width="243" height="432">'+
                '<source src="talia_dancing.mov">'+
                '</video>'+
                '</li>'+
                '<li class="li-slider">'+
                '<video width="243" height="432">'+
                '<source src="talia_dog.mov">'+
                '</video>'+
                '</li>'+
                '<li class="li-slider">'+
                '<video width="243" height="432">'+
                '<source src="squirrel.mov">'+
                '</video>'+
                '</li>'+
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="talia_dog.mov">'+
                // '</video>'+
                // '</li>'+
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="squirrel.mov">'+
                // '</video>'+
                // '</li>'+                
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="talia_dog.mov">'+
                // '</video>'+
                // '</li>'+
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="squirrel.mov">'+
                // '</video>'+
                // '</li>'+                
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="talia_dog.mov">'+
                // '</video>'+
                // '</li>'+
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="squirrel.mov">'+
                // '</video>'+
                // '</li>'+
                // '</li>'+
                // '<li class="li-slider">'+
                // '<video width="243" height="432">'+
                // '<source src="squirrel.mov">'+
                // '</video>'+
                // '</li>'+
            '</ul>'+
            '</div>'+
            '<div class="thumbnails">'+
            '<ul id="navlist">'+
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dancing.mov">'+
                '</video>'+
              '</li>'+
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dog.mov">'+
                '</video>'+
              '</li>'+              
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="squirrel.mov">'+
                '</video>'+
              '</li>'+             
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dancing.mov">'+
                '</video>'+
              '</li>'+
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dog.mov">'+
                '</video>'+
              '</li>'+              
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="squirrel.mov">'+
                '</video>'+
              '</li>'+           
               '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dancing.mov">'+
                '</video>'+
              '</li>'+
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="talia_dog.mov">'+
                '</video>'+
              '</li>'+              
              '<li>'+
                '<video width="48" height="86">'+
                '<source src="squirrel.mov">'+
                '</video>'+
              '</li>'+              
               '<li>'+
                '<video width="48" height="86">'+
                '<source src="squirrel.mov">'+
                '</video>'+
              '</li>'+            
            '</ul>'+
          '</div>'+
          '</div>'
        },
        // {
        //   name: "Uluru",
        //   lat: -25.363, 
        //   lng: 131.044,
        //   content:
        //   '<div id="slider-container">'+
        //     '<ul id="ul-slider">'+
        //         '<li class="li-slider first">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+                
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+                
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //     '</ul>'+
        //     '</div>'+
        //     '<div class="thumbnails">'+
        //     '<ul id="navlist">'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+             
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+           
        //        '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+ 
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+           
        //     '</ul>'+
        //   '</div>'   
        // },
        // {
        //   name: "Manhattan",
        //   lat: 40.758896,
        //   lng: -73.985130,
        //   content: 
        //   '<div id="slider-container">'+
        //     '<ul id="ul-slider">'+
        //         '<li class="li-slider first">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+                
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+                
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //         '</li>'+
        //         '<li class="li-slider">'+
        //         '<video width="243" height="432">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //         '</li>'+
        //     '</ul>'+
        //     '</div>'+
        //     '<div class="thumbnails">'+
        //     '<ul id="navlist">'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+             
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+           
        //        '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dancing.mov">'+
        //         '</video>'+
        //       '</li>'+
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="talia_dog.mov">'+
        //         '</video>'+
        //       '</li>'+              
        //       '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+ 
        //        '<li>'+
        //         '<video width="48" height="86">'+
        //         '<source src="squirrel.mov">'+
        //         '</video>'+
        //       '</li>'+            
        //     '</ul>'+
        //   '</div>'   
        // },
        // { name: "Salt lake City",
        //   lat: 40.759434, 
        //   lng: -111.888222
        // },
        // {
        //   name: "San Francisco",
        //   lat:  37.733795, 
        //   lng: -122.446747
        // },
        // {
        //   name: "Portland",
        //   lat:  45.523064,
        //   lng:-122.676483,
        //   //add html here
        // },
        // {
        //   name: "Seattle",
        //   lat: 47.608013, 
        //   lng: -122.335167
        // },
        // {
        //   name: "Manhattan",
        //   lat: 40.758896,
        //   lng: -73.985130
        // },
        // { name: "Miami",
        //   lat:  25.761681, 
        //   lng: -80.191788
        // },
        // {
        //   name: "Manila",
        //   lat:  14.556586, 
        //   lng:  121.023415
        // },
        // {
        //   name: "Hong Kong",
        //   lat:22.286394,
        //   lng: 114.149139,
        //   //add html here
        // },
        // {
        //   name: "Sydney",
        //   lat: -33.865143, 
        //   lng: 151.209900
        // },
        // {
        //   name: "Melbourne",
        //   lat: -37.815018,
        //   lng: 144.946014
        // },
        // { name: "Amsterdam",
        //   lat: 52.374355, 
        //   lng: 4.897960
        // },
        // {
        //   name: "London",
        //   lat:  51.508530, 
        //   lng: -0.076132
        // },
        //         {
        //   name: "Dublin",
        //   lat:  53.350140,
        //   lng: -6.266155,
        //   //add html here
        // },
        // {
        //   name: "Tel Aviv",
        //   lat: 32.109333, 
        //   lng: 34.855499
        // },
        // {
        //   name: "Dubai",
        //   lat: 25.276987,
        //   lng: 55.296249
        // },
        // { name: "Boston",
        //   lat:  42.364758, 
        //   lng: -71.067421
        // },
        // {
        //   name: "Hamburg",
        //   lat:  53.551086, 
        //   lng: 9.993682
        // },
        // {
        //   name: "Frankfurt",
        //   lat: 50.110924,
        //   lng: 8.682127,
        //   //add html here
        // },
        // {
        //   name: "Sao Paulo",
        //   lat: -22.121265, 
        //   lng: -51.383400
        // },
        // {
        //   name: "Mexico City",
        //   lat: 19.432608,
        //   lng: -99.133209
        // },
        // { name: "Honolulu",
        //   lat: 21.315603, 
        //   lng: -157.858093
        // },
        // {
        //   name: "Toronto",
        //   lat:  43.704926, 
        //   lng: -79.282280
        // },
        // {
        //   name: "Seoul",
        //   lat:  37.532600,
        //   lng: 127.024612,
        //   //add html here
        // },
        // {
        //   name: "Paris",
        //   lat: 48.858093, 
        //   lng: 2.294694
        // },
        // {
        //   name: "Rome",
        //   lat: 41.890251,
        //   lng: 12.492373
        // },
        // { name: "Tokyo",
        //   lat:  35.652832, 
        //   lng: 139.839478
        // },
        // {
        //   name: "Barcelona",
        //   lat:  41.390205, 
        //   lng:  2.154007
        // },
        // {
        //   name: "Berlin",
        //   lat:52.518623,
        //   lng: 13.376198,
        //   //add html here
        // },
        // {
        //   name: "Glasgow",
        //   lat:  55.865101, 
        //   lng: -4.433177
        // },
        // {
        //   name: "Moscow",
        //   lat: 55.751244,
        //   lng: 37.618423
        // },
        // { name: "Hanoi",
        //   lat:  21.033333, 
        //   lng: 105.849998
        // },
        // {
        //   name: "Bali",
        //   lat:  -8.409518, 
        //   lng: 115.188919
        // },
        //         {
        //   name: "Aukland",
        //   lat:  -36.848461,
        //   lng: 174.763336,
        //   //add html here
        // },
        // {
        //   name: "Stockholm",
        //   lat:  59.334591, 
        //   lng: 18.063240
        // },
        // {
        //   name: "Johannesburg",
        //   lat: -26.195246,
        //   lng: 28.034088
        // },
        // { name: "Marrakesh",
        //   lat:  31.669746, 
        //   lng: -7.973328
        // },
        // {
        //   name: "Istanbul",
        //   lat:  41.015137, 
        //   lng: 28.979530
        // },
        //         {
        //   name: "Nova Scotia",
        //   lat:  45.975269, 
        //   lng: -61.123970
        // },
        //         {
        //   name: "Reykjavik",
        //   lat:  64.135666,
        //   lng: -21.862675,
        //   //add html here
        // },
        // {
        //   name: "Oslo",
        //   lat:  59.911491, 
        //   lng: 10.757933
        // },
        // {
        //   name: "Beunos Aires",
        //   lat: -34.603722,
        //   lng: -58.381592
        // },
        // { name: "Bangkok",
        //   lat:  13.736717, 
        //   lng: 100.523186
        // },
        // {
        //   name: "Athens",
        //   lat:  38.004566, 
        //   lng: 23.716091
        // },
        // {
        //   name: "New Dehli",
        //   lat:  28.644800, 
        //   lng: 77.216721
        // },

      ];

      function initMap() {
       
        function drawMap() {
          var randomMarker = mapLocations[Math.floor(Math.random()*mapLocations.length)];      

          window.myMap.panTo(new google.maps.LatLng(randomMarker.lat, randomMarker.lng));
          // var infowindow = new google.maps.InfoWindow({
          //   content: randomMarker.content,
          //   //pixelOffset: new google.maps.Size(100,100)
          // });
          var infoBubble = new InfoBubble({
            maxHeight: 600,
            maxWidth: 600,
            content: randomMarker.content,
            backgroundColor: 'transparent',
            borderWidth: 0,
            borderColor: 'transparent',
            borderRadius: 0,
            shadowStyle: 0,
          });

          if(window.myMarker){
            window.myMarker.setMap(null);
          }
          //hack fix later 
          $(document).ready(function(){
            window.myMarker = new google.maps.Marker({
              position: {lat:randomMarker.lat, lng:randomMarker.lng},
              map: window.myMap,
              title: randomMarker.name
            });
            // if (window.myMarker==randomMarker.last){
            //   mapLocations[Math.floor(Math.random()*mapLocations.length)]; 
            // }
            // if (mapLocations.name=="Uluru"){
            //   mapLocations[Math.floor(Math.random()*mapLocations.length)]; 
            // }
           // infowindow.open(window.myMap, window.myMarker);
            infoBubble.open(window.myMap, window.myMarker);
            google.maps.event.addListener(infoBubble, 'domready', function() {
              console.log('dropped one');
              setTimeout(function() {
                console.log('i am in timeout');
                sliderLoad();
                $('#infobubble-container').css({ visibility: 'visible' });
//never start on au
//never replay same area x2
                var videos = $('#ul-slider li video');
                var currentVideo = 2;
                function hookVideo() {
                  $(videos[currentVideo-1]).trigger('play');
                  // console.log('video ' + currentVideo + '/' + videos.length + ' is playing')
                  videos[currentVideo-1].addEventListener('ended', function(e) {
                    if(currentVideo < videos.length) {
                      window.moveRight();
                      currentVideo++;
                      $(videos[currentVideo-1]).trigger('play');
                      return hookVideo();
                    } else {
                      currentVideo = 2;
                      infoBubble.close();
                      return setTimeout(drawMap, 1000);
                    }
                  });
                }
                hookVideo();
              }, 2000);
            });
          });
        }

        window.myMap = window.myMap || new google.maps.Map(document.getElementById('map'), {
          center: {lat: -25.363, lng: 131.044},
          zoom: 4
        });

        setTimeout(drawMap, 1000);

        //var intervalID = window.setInterval(drawMap, 5000);

      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAfSS1tVx9Qic34NaApwOelrfLli7FxkhU&callback=initMap">
    </script>
  </body>
</html>